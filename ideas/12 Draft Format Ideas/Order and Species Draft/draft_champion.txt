// draft_champion.c
// Champion deck generation and manipulation

#include <stdlib.h>
#include <string.h>
#include "draft_champion.h"
#include "game_constants.h"
#include "mtwister.h"

// Generate the 102-champion deck from fullDeck
SimplifiedChampion* generate_102_champion_deck(void)
{
    SimplifiedChampion* deck = malloc(102 * sizeof(SimplifiedChampion));
    if (!deck) {
        return NULL;
    }
    
    int index = 0;
    
    // Extract first 102 cards (all champions) from fullDeck
    for (int i = 0; i < 102; i++) {
        deck[index].species_id = fullDeck[i].species;
        deck[index].order_id = fullDeck[i].order;
        deck[index].color_id = fullDeck[i].color;
        index++;
    }
    
    return deck;
}

// Fisher-Yates shuffle
void shuffle_champion_deck(SimplifiedChampion* deck, int n, MTRand* rng)
{
    for (int i = n - 1; i > 0; i--) {
        int j = genRandLong(rng) % (i + 1);
        
        // Swap deck[i] and deck[j]
        SimplifiedChampion temp = deck[i];
        deck[i] = deck[j];
        deck[j] = temp;
    }
}

// Create a deep copy of champion array
SimplifiedChampion* copy_champion_array(SimplifiedChampion* src, int count)
{
    SimplifiedChampion* dst = malloc(count * sizeof(SimplifiedChampion));
    if (!dst) {
        return NULL;
    }
    
    memcpy(dst, src, count * sizeof(SimplifiedChampion));
    return dst;
}

// Free champion deck
void free_champion_deck(SimplifiedChampion* deck)
{
    free(deck);
}
